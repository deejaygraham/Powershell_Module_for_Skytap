<html>
<head>
<title>Skytap.psm1</title>
</head>
<body bgcolor="#ffffff">



<pre><font color="#000000"><span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   1 </font></span><font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$PSBoundParameters</strong></font><font color="#02b902">[</font><font color="#02b902">'Debug'</font><font color="#02b902">]</font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   2 </font></span>    <font color="#009966"><strong>$DebugPreference</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">'</font><font color="#ff00cc">Continue</font><font color="#ff00cc">'</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   3 </font></span><font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   4 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">   5 </font></span><font color="#009966"><strong>$global</strong></font>:username <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">'</font><font color="#ff00cc">'</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   6 </font></span><font color="#009966"><strong>$global</strong></font>:password <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">'</font><font color="#ff00cc">'</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   7 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   8 </font></span><font color="#cc0000">#</font><font color="#cc0000"> </font><font color="#cc0000">place</font><font color="#cc0000"> </font><font color="#cc0000">your</font><font color="#cc0000"> </font><font color="#cc0000">username</font><font color="#cc0000"> </font><font color="#cc0000">and</font><font color="#cc0000"> </font><font color="#cc0000">token</font><font color="#cc0000"> </font><font color="#cc0000">in</font><font color="#cc0000"> </font><font color="#cc0000">user_token.ps1</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   9 </font></span><font color="#cc0000">#</font><font color="#cc0000"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  10 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  11 </font></span><font color="#0099ff"><strong>Write-host</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">dot</font><font color="#6600cc"> </font><font color="#6600cc">sourcing</font><font color="#6600cc"> </font><font color="#6600cc">usertoken</font><font color="#6600cc"> </font><font color="#6600cc">file</font><font color="#6600cc"> </font><font color="#6600cc">now</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  12 </font></span><font color="#0099ff"><strong>Write-host</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">format:</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  13 </font></span><font color="#0099ff"><strong>Write-host</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc"> </font><font color="#6600cc"> </font><font color="#6600cc">`$global:username</font><font color="#6600cc"> </font><font color="#6600cc">=</font><font color="#6600cc"> </font><font color="#6600cc">&quot;</font>skytap@email<font color="#0000ff">.</font>com<font color="#6600cc">&quot;</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  14 </font></span><font color="#0099ff"><strong>Write-host</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc"> </font><font color="#6600cc"> </font><font color="#6600cc">`$global:password</font><font color="#6600cc"> </font><font color="#6600cc">=</font><font color="#6600cc"> </font><font color="#6600cc">&quot;</font>yourSkytapToken<font color="#6600cc">&quot;</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  15 </font></span><font color="#cc0000">#</font><font color="#cc0000">force</font><font color="#cc0000"> </font><font color="#cc0000">source</font><font color="#cc0000"> </font><font color="#cc0000">it</font><font color="#cc0000"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  16 </font></span><font color="#0000ff">.</font> <font color="#0000ff">.</font>\user_token<font color="#0000ff">.</font>ps1
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  17 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  18 </font></span><font color="#009966"><strong>$auth</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#02b902">[</font><font color="#02b902">Convert</font><font color="#02b902">]</font><font color="#0000ff">::</font><font color="#9966ff">ToBase64String</font><font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">Text.Encoding</font><font color="#02b902">]</font><font color="#0000ff">::</font>ASCII<font color="#0000ff">.</font><font color="#9966ff">GetBytes</font><font color="#0000ff">(</font><font color="#0000ff">(</font><font color="#6600cc">&quot;</font><font color="#6600cc">{0}:{1}</font><font color="#6600cc">&quot;</font> <font color="#000000"><strong>-f</strong></font> <font color="#009966"><strong>$global</strong></font>:username<font color="#0000ff">,</font><font color="#009966"><strong>$global</strong></font>:password<font color="#0000ff">)</font><font color="#0000ff">)</font><font color="#0000ff">)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  19 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  20 </font></span><font color="#cc0000">#</font><font color="#cc0000">forget</font><font color="#cc0000"> </font><font color="#cc0000">the</font><font color="#cc0000"> </font><font color="#cc0000">names</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  21 </font></span><font color="#009966"><strong>$global</strong></font>:username <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">'</font><font color="#ff00cc">'</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  22 </font></span><font color="#009966"><strong>$global</strong></font>:password <font color="#000000"><strong>=</strong></font> <font color="#ff00cc">'</font><font color="#ff00cc">'</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  23 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  24 </font></span><font color="#009966"><strong>$global</strong></font>:url <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">https://cloud.skytap.com</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  25 </font></span><font color="#009966"><strong>$global</strong></font>:headers <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font><font color="#6600cc">&quot;</font><font color="#6600cc">Accept</font><font color="#6600cc">&quot;</font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font>; Authorization<font color="#000000"><strong>=</strong></font><font color="#0000ff">(</font><font color="#6600cc">&quot;</font><font color="#6600cc">Basic</font><font color="#6600cc"> </font><font color="#6600cc">{0}</font><font color="#6600cc">&quot;</font> <font color="#000000"><strong>-f</strong></font> <font color="#009966"><strong>$auth</strong></font><font color="#0000ff">)</font><font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  26 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  27 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  28 </font></span><font color="#006699"><strong>function</strong></font> Show-APIFailure <font color="#0000ff">(</font><font color="#009966"><strong>$eresp</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  29 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  30 </font></span>    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$eresp</strong></font><font color="#0000ff">.</font><font color="#9966ff">GetResponseStream</font><font color="#0000ff">(</font><font color="#0000ff">)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  31 </font></span>    <font color="#009966"><strong>$reader</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#0099ff"><strong>New-Object</strong></font> System<font color="#0000ff">.</font>IO<font color="#0000ff">.</font><font color="#9966ff">StreamReader</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  32 </font></span>    <font color="#009966"><strong>$reader</strong></font><font color="#0000ff">.</font>BaseStream<font color="#0000ff">.</font>Position <font color="#000000"><strong>=</strong></font> <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  33 </font></span>    <font color="#009966"><strong>$reader</strong></font><font color="#0000ff">.</font><font color="#9966ff">DiscardBufferedData</font><font color="#0000ff">(</font><font color="#0000ff">)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  34 </font></span>    <font color="#009966"><strong>$responseBody</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$reader</strong></font><font color="#0000ff">.</font><font color="#9966ff">ReadToEnd</font><font color="#0000ff">(</font><font color="#0000ff">)</font>;
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  35 </font></span>    <font color="#009966"><strong>$nob</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#0099ff"><strong>New-Object</strong></font> -TypeName psobject -Property @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  36 </font></span>        requestResultCode <font color="#000000"><strong>=</strong></font> <font color="#02b902">[</font><font color="#02b902">int</font><font color="#02b902">]</font><font color="#009966"><strong>$eresp</strong></font><font color="#0000ff">.</font>StatusCode
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  37 </font></span>        eDescription <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$eresp</strong></font><font color="#0000ff">.</font>StatusDescription
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  38 </font></span>        eMessage <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$responseBody</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  39 </font></span>        method <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$eresp</strong></font><font color="#0000ff">.</font>Method
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  40 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  41 </font></span>    <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$nob</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  42 </font></span>    
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  43 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  44 </font></span><font color="#0000ff">}</font>   
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  45 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  46 </font></span><font color="#006699"><strong>function</strong></font> Set-runstateColor <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  47 </font></span>    <font color="#006699"><strong>switch</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$global</strong></font>:vm_state<font color="#0000ff">)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  48 </font></span>    <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  49 </font></span>        <font color="#6600cc">&quot;</font><font color="#6600cc">running</font><font color="#6600cc">&quot;</font> <font color="#0000ff">{</font> <font color="#009966"><strong>$global</strong></font>:mcolor <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">green</font><font color="#6600cc">&quot;</font> <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  50 </font></span>        <font color="#6600cc">&quot;</font><font color="#6600cc">suspended</font><font color="#6600cc">&quot;</font> <font color="#0000ff">{</font> <font color="#009966"><strong>$global</strong></font>:mcolor <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">yellow</font><font color="#6600cc">&quot;</font> <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  51 </font></span>        <font color="#6600cc">&quot;</font><font color="#6600cc">stopped</font><font color="#6600cc">&quot;</font> <font color="#0000ff">{</font> <font color="#009966"><strong>$global</strong></font>:mcolor <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">red</font><font color="#6600cc">&quot;</font> <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  52 </font></span>        <font color="#6600cc">&quot;</font><font color="#6600cc">busy</font><font color="#6600cc">&quot;</font> <font color="#0000ff">{</font> <font color="#009966"><strong>$global</strong></font>:mcolor <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">purple</font><font color="#6600cc">&quot;</font> <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  53 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  54 </font></span><font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  55 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  56 </font></span><font color="#006699"><strong>function</strong></font> Add-ConfigurationToProject <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$projectId</strong></font> <font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  57 </font></span> <font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  58 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  59 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Adds</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font><font color="#ff8400">to</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">project</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  60 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  61 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-ConfigurationToProject</font><font color="#ff8400"> </font><font color="#ff8400">EnvironmentId</font><font color="#ff8400"> </font><font color="#ff8400">ProjectId</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  62 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  63 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-ConfigurationToProject</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">54321</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  64 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  65 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  66 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/projects/$projectId/configurations/$configId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  67 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  68 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  69 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  70 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  71 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  72 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  73 </font></span>        <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  74 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  75 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  76 </font></span><font color="#006699"><strong>function</strong></font> Update-RunState <font color="#0000ff">(</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$newstate</strong></font> <font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  77 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  78 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  79 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Change</font><font color="#ff8400"> </font><font color="#ff8400">and</font><font color="#ff8400"> </font><font color="#ff8400">environments</font><font color="#ff8400"> </font><font color="#ff8400">runstate</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  80 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  81 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Update-RunState</font><font color="#ff8400"> </font><font color="#ff8400">ConfigId</font><font color="#ff8400"> </font><font color="#ff8400">State</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  82 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  83 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Update-RunState</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">running</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  84 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  85 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  86 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/configurations/$configId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  87 </font></span>        
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  88 </font></span>        <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  89 </font></span>            runstate <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$newstate</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  90 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  91 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method PUT -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font>  -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  92 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  93 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  94 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  95 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  96 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  97 </font></span>    <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  98 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  99 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 100 </font></span><font color="#006699"><strong>function</strong></font> Connect<font color="#000000"><strong>-Ne</strong></font>twork <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$sourceNetwork</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$destinationNetwork</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 101 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 102 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 103 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Connect</font><font color="#ff8400"> </font><font color="#ff8400">two</font><font color="#ff8400"> </font><font color="#ff8400">networks</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 104 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 105 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Connect-Network</font><font color="#ff8400"> </font><font color="#ff8400">Source-Network</font><font color="#ff8400"> </font><font color="#ff8400">Destination-Network</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 106 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 107 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Connect-Network</font><font color="#ff8400"> </font><font color="#ff8400">78901</font><font color="#ff8400"> </font><font color="#ff8400">10987</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 108 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 109 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 110 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/tunnels</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 111 </font></span>        <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 112 </font></span>                source_network_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$sourceNetwork</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 113 </font></span>                target_network_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$destinationNetwork</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 114 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 115 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 116 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 117 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 118 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 119 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 120 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 121 </font></span>    <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 122 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 123 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 124 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 125 </font></span><font color="#006699"><strong>function</strong></font> New-EnvironmentfromTemplate <font color="#0000ff">(</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$templateId</strong></font> <font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 126 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 127 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 128 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Create</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">new</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font><font color="#ff8400">from</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">template</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 129 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 130 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">New-EnvironmentfromTemplate</font><font color="#ff8400"> </font><font color="#ff8400">templateId</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 131 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">new</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font><font color="#ff8400">ID</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 132 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 133 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">New-EnvironmentfromTemplate</font><font color="#ff8400"> </font><font color="#ff8400">12345</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 134 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 135 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 136 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 137 </font></span>        <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 138 </font></span>                template_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$templateId</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 139 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 140 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 141 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 142 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 143 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 144 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 145 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 146 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 147 </font></span>        <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 148 </font></span>    
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 149 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 150 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 151 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 152 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 153 </font></span><font color="#006699"><strong>function</strong></font> Publish-URL <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$ptype</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$pname</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 154 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 155 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 156 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Create</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">published</font><font color="#ff8400"> </font><font color="#ff8400">url</font><font color="#ff8400"> </font><font color="#ff8400">for</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 157 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 158 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Publish-URL</font><font color="#ff8400"> </font><font color="#ff8400">configId</font><font color="#ff8400"> </font><font color="#ff8400">[type]</font><font color="#ff8400"> </font><font color="#ff8400">[name]</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 159 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">new</font><font color="#ff8400"> </font><font color="#ff8400">URL</font><font color="#ff8400"> </font><font color="#ff8400">ID</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 160 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 161 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Publish-URL</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">multiple_url</font><font color="#ff8400"> </font><font color="#ff8400">&quot;Class</font><font color="#ff8400"> </font><font color="#ff8400">123&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 162 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 163 </font></span>        <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 164 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/publish_sets</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 165 </font></span>            <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$ptype</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 166 </font></span>                <font color="#009966"><strong>$type</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$ptype</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 167 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>else</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 168 </font></span>                <font color="#009966"><strong>$type</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">single_url</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 169 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 170 </font></span>            <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$pname</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 171 </font></span>                <font color="#009966"><strong>$name</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$pname</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 172 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>else</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 173 </font></span>                <font color="#009966"><strong>$name</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">Published</font><font color="#6600cc"> </font><font color="#6600cc">set</font><font color="#6600cc"> </font><font color="#6600cc">-</font><font color="#6600cc"> </font><font color="#6600cc">$type</font><font color="#6600cc">&quot;</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 174 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 175 </font></span>            
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 176 </font></span>            <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 177 </font></span>                    name <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$name</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 178 </font></span>                    publish_set_type <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$type</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 179 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 180 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 181 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 182 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 183 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 184 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 185 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 186 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 187 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 188 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 189 </font></span><font color="#006699"><strong>function</strong></font> Save-ConfigurationToTemplate <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$tname</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 190 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 191 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 192 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Save</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font><font color="#ff8400">as</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">template</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 193 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 194 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Save-ConfigurationToTemplate</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 195 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">template</font><font color="#ff8400"> </font><font color="#ff8400">ID</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 196 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 197 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Save-ConfigurationToTemplate</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 198 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 199 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 200 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/templates</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 201 </font></span>            <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$tname</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 202 </font></span>                <font color="#009966"><strong>$name</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$tname</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 203 </font></span>                <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 204 </font></span>                    configuration_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$configId</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 205 </font></span>                    name <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$name</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 206 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 207 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>else</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 208 </font></span>                <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 209 </font></span>                    configuration_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$configId</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 210 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 211 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 212 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 213 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 214 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 215 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 216 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 217 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 218 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 219 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 220 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 221 </font></span><font color="#006699"><strong>function</strong></font> Remove-Configuration <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 222 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 223 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 224 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Remove</font><font color="#ff8400"> </font><font color="#ff8400">(DELETE)</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 225 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 226 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Remove-Configuration</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 227 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 228 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Remove-Configuration</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 229 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 230 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 231 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/configurations/$configId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 232 </font></span>            
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 233 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method DELETE -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 234 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 235 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 236 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 237 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 238 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 239 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 240 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 241 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 242 </font></span><font color="#006699"><strong>function</strong></font> Add-TemplateToProject <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$projectId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$templateId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 243 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 244 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 245 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Adds</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">template</font><font color="#ff8400"> </font><font color="#ff8400">to</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">project</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 246 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 247 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-TemplateToProject</font><font color="#ff8400"> </font><font color="#ff8400">TemplateId</font><font color="#ff8400"> </font><font color="#ff8400">ProjectId</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 248 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 249 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-TemplateToProject</font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">54321</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 250 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 251 </font></span>        <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 252 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$url/projects/$projectId/templates/$templateId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 253 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$headers</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 254 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 255 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 256 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 257 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>       
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 258 </font></span>        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 259 </font></span>        <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 260 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 261 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 262 </font></span><font color="#006699"><strong>function</strong></font> Add-TemplateToConfiguration <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$templateId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 263 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 264 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 265 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Adds</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">template</font><font color="#ff8400"> </font><font color="#ff8400">to</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 266 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 267 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-TemplateToConfiguration</font><font color="#ff8400"> </font><font color="#ff8400">EnvironmentId</font><font color="#ff8400"> </font><font color="#ff8400">TemplateId</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 268 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 269 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Add-TemplateToConfiguration</font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">54321</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 270 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 271 </font></span>    <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 272 </font></span>        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 273 </font></span>        <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 274 </font></span>                template_id <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$templateId</strong></font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 275 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 276 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method PUT -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 277 </font></span>        <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 278 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 279 </font></span>            <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 280 </font></span>                <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 281 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 282 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 283 </font></span>        <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 284 </font></span>    
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 285 </font></span>    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 286 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 287 </font></span><font color="#006699"><strong>function</strong></font> Publish-Service <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$vmId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$interfaceId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$serviceId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$port</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 288 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 289 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 290 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Create</font><font color="#ff8400"> </font><font color="#ff8400">a</font><font color="#ff8400"> </font><font color="#ff8400">published</font><font color="#ff8400"> </font><font color="#ff8400">service</font><font color="#ff8400"> </font><font color="#ff8400">for</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 291 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 292 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Publish-Service</font><font color="#ff8400"> </font><font color="#ff8400">configId</font><font color="#ff8400"> </font><font color="#ff8400">vmId</font><font color="#ff8400"> </font><font color="#ff8400">interfaceId</font><font color="#ff8400"> </font><font color="#ff8400">serviceId</font><font color="#ff8400"> </font><font color="#ff8400">port_Number</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 293 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">new</font><font color="#ff8400"> </font><font color="#ff8400">service</font><font color="#ff8400"> </font><font color="#ff8400">url</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 294 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 295 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Publish-Service</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">54321</font><font color="#ff8400"> </font><font color="#ff8400">11111</font><font color="#ff8400"> </font><font color="#ff8400">22222</font><font color="#ff8400"> </font><font color="#ff8400">8080</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 296 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 297 </font></span>            <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 298 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/vms/$vmId/interfaces/$interfaceId/services/$serviceId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 299 </font></span>            
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 300 </font></span>            <font color="#009966"><strong>$body</strong></font> <font color="#000000"><strong>=</strong></font> @<font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 301 </font></span>                    port <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$port</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 302 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 303 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method POST -Body <font color="#0000ff">(</font>ConvertTo-Json <font color="#009966"><strong>$body</strong></font><font color="#0000ff">)</font> -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 304 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 305 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 306 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 307 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 308 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 309 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 310 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 311 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 312 </font></span><font color="#006699"><strong>function</strong></font> Get-PublishedURLs <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 313 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 314 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 315 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">published</font><font color="#ff8400"> </font><font color="#ff8400">URLs</font><font color="#ff8400"> </font><font color="#ff8400">for</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 316 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 317 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-PublishedURLs</font><font color="#ff8400"> </font><font color="#ff8400">configId</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 318 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">of</font><font color="#ff8400"> </font><font color="#ff8400">URLs</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 319 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 320 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-PublishedURLs</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 321 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 322 </font></span>        <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 323 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/publish_sets</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 324 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 325 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 326 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 327 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 328 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 329 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 330 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 331 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 332 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 333 </font></span><font color="#006699"><strong>function</strong></font> Get-PublishedServices <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$vmId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$interfaceId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 334 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 335 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 336 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">published</font><font color="#ff8400"> </font><font color="#ff8400">services</font><font color="#ff8400"> </font><font color="#ff8400">for</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 337 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 338 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-PublishedServices</font><font color="#ff8400"> </font><font color="#ff8400">configId</font><font color="#ff8400"> </font><font color="#ff8400">vmId</font><font color="#ff8400"> </font><font color="#ff8400">interfaceId</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 339 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">service(s)</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 340 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 341 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-PublishedURLs</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 342 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 343 </font></span>            <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 344 </font></span>            <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/vms/$vmId/interfaces/$interfaceId/services</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 345 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 346 </font></span>            <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 347 </font></span>                <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 348 </font></span>                    <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 349 </font></span>                    <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 350 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 351 </font></span>            <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 352 </font></span>            <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 353 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 354 </font></span><font color="#006699"><strong>function</strong></font> Get-VMs <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$vm</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 355 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 356 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 357 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">VMs</font><font color="#ff8400"> </font><font color="#ff8400">for</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 358 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 359 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-VMs</font><font color="#ff8400"> </font><font color="#ff8400">configId</font><font color="#ff8400"> </font><font color="#ff8400">[vmId]</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 360 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">vm(s)</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 361 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 362 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">All</font><font color="#ff8400"> </font><font color="#ff8400">VMs</font><font color="#ff8400"> </font><font color="#ff8400">in</font><font color="#ff8400"> </font><font color="#ff8400">an</font><font color="#ff8400"> </font><font color="#ff8400">environment</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 363 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-VMs</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 364 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Only</font><font color="#ff8400"> </font><font color="#ff8400">specific</font><font color="#ff8400"> </font><font color="#ff8400">VM</font><font color="#ff8400"> </font><font color="#ff8400">details</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 365 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-VMs</font><font color="#ff8400"> </font><font color="#ff8400">12345</font><font color="#ff8400"> </font><font color="#ff8400">54321</font><font color="#ff8400"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 366 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 367 </font></span>            <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 368 </font></span>                <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$vm</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 369 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/vms/$vm</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 370 </font></span>                <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 371 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId/vms</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 372 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 373 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 374 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 375 </font></span>                    <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 376 </font></span>                        <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 377 </font></span>                        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 378 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 379 </font></span>                <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 380 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 381 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 382 </font></span><font color="#006699"><strong>function</strong></font> Get-Projects <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$projectId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 383 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 384 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 385 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">projects</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 386 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 387 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Projects</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 388 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">service(s)</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 389 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 390 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Projects</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 391 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 392 </font></span>                <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 393 </font></span>                <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$projectId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 394 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/projects/$projectId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 395 </font></span>                <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 396 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/projects</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 397 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 398 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 399 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 400 </font></span>                    <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 401 </font></span>                        <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 402 </font></span>                        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 403 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 404 </font></span>                <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 405 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 406 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 407 </font></span><font color="#006699"><strong>function</strong></font> Get-Users <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$userId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 408 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 409 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 410 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">all</font><font color="#ff8400"> </font><font color="#ff8400">users</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 411 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 412 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Users</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 413 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">users</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 414 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 415 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Users</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 416 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 417 </font></span>            <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 418 </font></span>                <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$userId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 419 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/users/$userId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 420 </font></span>                <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 421 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/users</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 422 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 423 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 424 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 425 </font></span>                    <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 426 </font></span>                        <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 427 </font></span>                        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 428 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 429 </font></span>                <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 430 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 431 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 432 </font></span><font color="#006699"><strong>function</strong></font> Get-Configurations <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 433 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 434 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 435 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">environment(s)</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 436 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 437 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Configurations</font><font color="#ff8400"> </font><font color="#ff8400">[configId]</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 438 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">environment(s)</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 439 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 440 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">All</font><font color="#ff8400"> </font><font color="#ff8400">environments</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 441 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Configurations</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 442 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Only</font><font color="#ff8400"> </font><font color="#ff8400">specific</font><font color="#ff8400"> </font><font color="#ff8400">environment</font><font color="#ff8400"> </font><font color="#ff8400">details</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 443 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Configurations</font><font color="#ff8400"> </font><font color="#ff8400">12345</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 444 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 445 </font></span>                <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 446 </font></span>                <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$configId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 447 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations/$configId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 448 </font></span>                <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 449 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/configurations</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 450 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 451 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 452 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 453 </font></span>                    <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 454 </font></span>                        <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 455 </font></span>                        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 456 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 457 </font></span>                <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 458 </font></span>                <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 459 </font></span>                
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 460 </font></span><font color="#006699"><strong>function</strong></font> Get-Templates <font color="#0000ff">(</font><font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$templateId</strong></font><font color="#0000ff">,</font> <font color="#02b902">[</font><font color="#02b902">string</font><font color="#02b902">]</font><font color="#009966"><strong>$attributes</strong></font><font color="#0000ff">)</font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 461 </font></span><font color="#ff8400">&lt;#</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 462 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNOPSIS</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 463 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get</font><font color="#ff8400"> </font><font color="#ff8400">template(s)</font><font color="#ff8400"> </font><font color="#ff8400">optionally</font><font color="#ff8400"> </font><font color="#ff8400">filter</font><font color="#ff8400"> </font><font color="#ff8400">by</font><font color="#ff8400"> </font><font color="#ff8400">attributes</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 464 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.SYNTAX</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 465 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Get-Templates</font><font color="#ff8400"> </font><font color="#ff8400">[templateId]</font><font color="#ff8400"> </font><font color="#ff8400">[attribute</font><font color="#ff8400"> </font><font color="#ff8400">value</font><font color="#ff8400"> </font><font color="#ff8400">pairs]</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 466 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Returns</font><font color="#ff8400"> </font><font color="#ff8400">template(s)</font><font color="#ff8400"> </font><font color="#ff8400">list</font><font color="#ff8400"> </font><font color="#ff8400">object</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 467 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">.EXAMPLE</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 468 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">All</font><font color="#ff8400"> </font><font color="#ff8400">templates</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 469 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">  </font><font color="#ff8400">Get-Templates</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 470 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">  </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 471 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Only</font><font color="#ff8400"> </font><font color="#ff8400">templates</font><font color="#ff8400"> </font><font color="#ff8400">that</font><font color="#ff8400"> </font><font color="#ff8400">are</font><font color="#ff8400"> </font><font color="#ff8400">non-public</font><font color="#ff8400"> </font><font color="#ff8400">in</font><font color="#ff8400"> </font><font color="#ff8400">US-West</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 472 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">   </font><font color="#ff8400">Get-Templates</font><font color="#ff8400"> </font><font color="#ff8400">-attributes</font><font color="#ff8400"> </font><font color="#ff8400">&quot;public=False,region=USWest&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 473 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">   </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 474 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">Only</font><font color="#ff8400"> </font><font color="#ff8400">specific</font><font color="#ff8400"> </font><font color="#ff8400">template</font><font color="#ff8400"> </font><font color="#ff8400">details</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 475 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">    </font><font color="#ff8400">Get-Templates</font><font color="#ff8400"> </font><font color="#ff8400">12345</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 476 </font></span><font color="#ff8400"> </font><font color="#ff8400"> </font><font color="#ff8400">#&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 477 </font></span>            <font color="#006699"><strong>try</strong></font> <font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 478 </font></span>                <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$attributes</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 479 </font></span>                    <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/templates?$attributes</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 480 </font></span>                <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 481 </font></span>                    <font color="#006699"><strong>if</strong></font> <font color="#0000ff">(</font><font color="#009966"><strong>$templateId</strong></font><font color="#0000ff">)</font><font color="#0000ff">{</font>   
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 482 </font></span>                        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/templates/$templateId</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 483 </font></span>                    <font color="#0000ff">}</font><font color="#006699"><strong>else</strong></font><font color="#0000ff">{</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 484 </font></span>                        <font color="#009966"><strong>$uri</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#6600cc">&quot;</font><font color="#6600cc">$global:url/templates</font><font color="#6600cc">&quot;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 485 </font></span>                        <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 486 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 487 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> Invoke-RestMethod -Uri <font color="#009966"><strong>$uri</strong></font> -Method GET -ContentType <font color="#6600cc">&quot;</font><font color="#6600cc">application/json</font><font color="#6600cc">&quot;</font> -Headers <font color="#009966"><strong>$global</strong></font>:headers 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 488 </font></span>                <font color="#009966"><strong>$result</strong></font> <font color="#0000ff">|</font> <font color="#0099ff"><strong>Add-member</strong></font> -MemberType NoteProperty -name requestResultCode -value <font color="#ff0000">0</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 489 </font></span>                    <font color="#0000ff">}</font> <font color="#006699"><strong>catch</strong></font> <font color="#0000ff">{</font> 
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 490 </font></span>                        <font color="#009966"><strong>$errorResponse</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#009966"><strong>$_</strong></font><font color="#0000ff">.</font>Exception<font color="#0000ff">.</font>Response
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 491 </font></span>                        <font color="#009966"><strong>$result</strong></font> <font color="#000000"><strong>=</strong></font> <font color="#9966ff">Show-APIFailure</font><font color="#0000ff">(</font><font color="#009966"><strong>$errorResponse</strong></font><font color="#0000ff">)</font>           
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 492 </font></span>                    <font color="#0000ff">}</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 493 </font></span>                <font color="#006699"><strong>return</strong></font> <font color="#009966"><strong>$result</strong></font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 494 </font></span>                <font color="#0000ff">}</font>   
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066"> 495 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 496 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 497 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000"> 498 </font></span>
</font></pre>
</body>
</html>
